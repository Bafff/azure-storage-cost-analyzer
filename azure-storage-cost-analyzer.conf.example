# Azure Storage Monitor Configuration File
# Copy this file to one of the following locations (in priority order):
#   1. Specify with --config <path>
#   2. /etc/azure-storage-cost-analyzer/config.conf (system-wide)
#   3. ~/.azure-storage-cost-analyzer.conf (user-specific)
#   4. ./azure-storage-cost-analyzer.conf (local directory)

[azure]
# Azure subscriptions to scan
# Use "all" for all accessible subscriptions, or comma-separated list of subscription IDs
subscriptions = all
# Example with specific subscriptions:
# subscriptions = 2f929c0a-d1f4-480c-a610-f75d1862fd53, 03d76f78-4676-4116-b53a-162546996207

# Resource group filter (optional, empty = all resource groups)
resource_group =

# Date range for cost analysis (in days from now)
# Example: 30 means analyze last 30 days
date_range_days = 30

# Include attached disks in analysis (true/false)
include_attached = false

[output]
# Output format: json, zabbix, text, csv
format = json

# Verbosity: silent, quiet, normal, verbose, debug
verbosity = quiet

[zabbix]
# Enable Zabbix integration (true/false)
enabled = true

# Zabbix server configuration
server = monitoring.company.com
port = 10051
hostname = azure-storage-cost-analyzer

# Auto-send metrics to Zabbix (true/false)
auto_send = true

# Zabbix agentd config file (alternative to server/port)
# config_file = /etc/zabbix/zabbix_agentd.conf

[thresholds]
# Warning threshold (monthly cost in USD)
warning_monthly = 50.00

# Critical threshold (monthly cost in USD)
critical_monthly = 100.00

# Alert on disk count thresholds
warning_disk_count = 10
critical_disk_count = 20

[advanced]
# Sort order: size, rg, date
sort_by = size

[exclusions]
# ============================================================================
# REVIEW DATE TAG EXCLUSION (Approved Exceptions)
# ============================================================================
# Resources with this tag and a future date will be excluded from alerts
# until the review date is reached

# Tag name to check on resources
review_date_tag_name = Resource-Next-Review-Date

# Expected date format (strict validation)
review_date_format = YYYY.MM.DD

# Exclude resources with valid future review dates from alerts
# true = exclude from metrics/alerts until review date
# false = show all resources with tag status annotations
exclude_pending_review = true

# Example tag usage on Azure resources:
#   Resource-Next-Review-Date: 2025.12.30  → Excluded until Dec 30, 2025
#   Resource-Next-Review-Date: 2024.11.01  → Included (review overdue)
#   Resource-Next-Review-Date: approved    → Included + flagged as invalid tag

# Note: Resources with expired tags (past dates) are ALWAYS included in alerts
# as the review date has passed and needs attention.

# ============================================================================
# RESOURCE GROUP EXCLUSION (Ephemeral Resources)
# ============================================================================
# Exclude specific resource groups from scanning, with age-based exceptions
# to catch orphaned/stuck resources that are unexpectedly old

# Comma-separated list of resource groups to exclude
# Example: databricks-rg,temp-rg,ephemeral-resources-rg
exclude_resource_groups =

# Age threshold in days - disks older than this will be included even
# if they're in an excluded resource group (anomaly detection)
# Default: 7 days
exclude_rg_age_threshold_days_disks = 7

# Age threshold for snapshots - snapshots older than this will be included
# even if they're in an excluded resource group (anomaly detection)
# Default: 30 days
exclude_rg_age_threshold_days_snapshots = 30

# Use Case Example:
# Databricks creates/deletes disks regularly as part of normal operations.
# These ephemeral disks are typically short-lived (hours/days).
# However, if a disk is > 7 days old or a snapshot is > 30 days old,
# it's likely orphaned/stuck and needs attention.
#
# Example configuration for Databricks:
#   exclude_resource_groups = databricks-managed-rg,databricks-compute-rg
#   exclude_rg_age_threshold_days_disks = 7
#   exclude_rg_age_threshold_days_snapshots = 30
#
# Result:
#   - Databricks disks < 7 days old: EXCLUDED from alerts (normal operation)
#   - Databricks disks >= 7 days old: INCLUDED in alerts (potential issue)
#   - Databricks snapshots < 30 days old: EXCLUDED from alerts
#   - Databricks snapshots >= 30 days old: INCLUDED in alerts (potential issue)
#   - All other RG resources: INCLUDED normally

# ============================================================================
